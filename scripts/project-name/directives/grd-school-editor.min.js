app.directive("grdSchoolEditor",[app.Services.Repository,app.Services.Log,function(n,t){return{restrict:"AE",scope:{dataItem:"=ngModel"},replace:!0,template:kendo.template($("#grdSchoolEditor").html(),{useWithBlock:!1}),controller:["$scope","$attrs",function(n){function u(n){return!isNaN(parseFloat(n))&&isFinite(n)}function r(n){return"true".startsWith(n)?!0:"false".startsWith(n)?!1:null}function f(n,i){var r=kendo.guid();t.log("checkbox",i);$('<div class="custom-control fill-checkbox custom-control-grid"><label class="custom-control fill-checkbox custom-control-grid" for="InActive"><input name="InActive" id="InActive" data-bind="value: '+i.field+'" class="fill-control-input" type="checkbox"/><span class="fill-control-indicator fill-control-kendogrid"><\/span><\/label><\/div>').appendTo(n)}t.log("dataitem editor",n.dataItem);t.log("recruitment.model.SchoolCourse",recruitment.model.SchoolCourse);var i=!1;$("#grdCourses").kendoGrid({toolbar:[{name:"create",text:"Add School Course"},"excel",{text:"Search",template:'<input class="k-textbox" id="filter" style="float: right" placeholder="Search" />'},],scrollable:!0,pageable:!0,resizable:!0,noRecords:{template:'<div class="k-grid-norecords ng-scope"><div class="k-grid-norecords-template" style="text-align:center;">No Entry Found<\/div><\/div>'},sortable:!0,editable:{mode:"inline",confirmation:!1},dataSource:{pageSize:10,batch:!1,transport:{create:function(i){i.data.UID=Guid.NewGuid();t.log("create e.data",i.data);t.log("create schoolcourse",n.dataItem.SchoolCourse);n.dataItem.set("DirtyUID",Guid.NewGuid());i.success(i.data)},read:function(t){if(n.dataItem.SchoolCourse.length<=0)t.success(n.dataItem.SchoolCourse);else{var i={total:n.dataItem.SchoolCourse.length,data:n.dataItem.SchoolCourse};t.success(i.data)}console.log("read e.data",t.data);console.log("read schoolcourse",n.dataItem.SchoolCourse)},update:function(i){t.log("update",i);n.dataItem.set("DirtyUID",Guid.NewGuid());t.log("update e.data",i.data);t.log("update schoolcourse",n.dataItem.SchoolCourse);i.success(i.data)},destroy:function(i){n.dataItem.set("DirtyUID",Guid.NewGuid());t.log("destroy e.data",i.data);t.log("destory schoolcourse",n.dataItem.SchoolCourse);i.success(i.data)}},schema:{model:recruitment.model.SchoolCourse.kendoModel,data:function(n){return t.log("schema data",n),n},total:function(n){return t.log("schema total",n),n.length}},requestStart:function(n){t.log("requeststart");i&&(n.preventDefault(),"")}},edit:function(){t.log("edit");i=!0},save:function(n){t.log("save",n);i=!1},remove:function(){t.log("remove");i=!1},cancel:function(n){t.log("cancel",n);i=!1},dataBound:function(n){var t=n.sender.element.find("tbody tr .k-grid-edit"),i=n.sender.element.find("tbody tr .k-grid-delete");t.each(function(){var t=n.sender.dataItem($(this).closest("tr"));t.CanUpdate!==undefined&&(t.CanUpdate||$(this).replaceWith('<span class="k-icon k-i-lock" style="position:relative; left: 8px;"><\/span>'))});i.each(function(){var t=n.sender.dataItem($(this).closest("tr"));t.CanDelete!==undefined&&(t.CanDelete||$(this).replaceWith('<span class="k-icon k-i-lock" style="position:relative; left: 8px;"><\/span>'))})},columns:[{field:"CourseCode",title:"Course Code",width:150},{field:"CourseName",title:"Course Name",width:200},{field:"InActive",title:"Inactive",template:'<div class="custom-control fill-checkbox custom-control-grid"><label class="custom-control fill-checkbox custom-control-grid" for="InActive"><input type="checkbox" #= InActive ? \'checked="checked"\' : "" # class="fill-control-input" type="checkbox"/><span class="fill-control-indicator fill-control-kendogrid"><\/span><\/label><\/div>',width:70,editor:f},{command:[{name:"edit",text:{edit:"",cancel:"",update:""},template:"<a grdSchoolCourse-update class='k-button k-grid-edit'><i class='material-icons md-18'>edit<\/i><\/a>"},],title:"",width:70},{command:[{name:"destroy",text:"",template:"<a grdSchoolCourse-delete class='k-button k-grid-delete'><i class='material-icons md-18'>delete<\/i><\/a>"},],title:"",width:70}]}).data("kendoGrid");$("#filter").on("keydown",function(n){var i=$("#grdCourses").data("kendoGrid"),f=i.columns,t={logic:"or",filters:[]};console.log("e.target.value",n.target.value);n.keyCode===13&&(console.log("clicked"),n.target.value!==""?(f.forEach(function(f){var e,s,o,h,c;if(f.field)if(f.field.includes("."))t.filters.push({field:f.field,operator:"contains",value:n.target.value});else if(e=i.dataSource.options.schema.model.fields[f.field].type,e==="string")t.filters.push({field:f.field,operator:"contains",value:n.target.value});else if(e==="number")u(n.target.value)&&t.filters.push({field:f.field,operator:"eq",value:n.target.value});else if(e==="date")for(s=i.dataSource.data(),o=0;o<s.length;o++)h=kendo.format(f.format,s[o][f.field]),h.startsWith(n.target.value)&&t.filters.push({field:f.field,operator:"eq",value:s[o][f.field]});else e==="boolean"&&r(n.target.value)!==null&&(c=r(n.target.value),t.filters.push({field:f.field,operator:"eq",value:c}))}),i.dataSource.filter(t)):(console.log("filter([])"),i.dataSource.filter([])))})}]}}]);